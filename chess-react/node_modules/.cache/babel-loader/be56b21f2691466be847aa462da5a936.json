{"ast":null,"code":"import _classCallCheck from\"/Users/ragir/Documents/chess/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ragir/Documents/chess/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/ragir/Documents/chess/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/ragir/Documents/chess/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Redirect}from'react-router-dom';import{Button,Modal,Spinner}from'react-bootstrap';import NavBar from'./NavBar';import chess from'./chess1.jpg';import{connect}from'react-redux';var Play=/*#__PURE__*/function(_Component){_inherits(Play,_Component);var _super=_createSuper(Play);function Play(){var _this;_classCallCheck(this,Play);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={gameId:null,waiting:false,color:null,userId:null,playWithFriends:false};_this.playWithFriends=function(){_this.setState({playWithFriends:true});};_this.getDate=function(){var userId=Math.floor(new Date().getTime()/1000);_this.setState({userId:userId});return userId;};_this.hide=function(){_this.setState({waiting:false});console.log('socket closed');_this.socket.close();};_this.search=function(){_this.setState({waiting:true});_this.socket=new WebSocket(\"ws://localhost:8080/online/\"+_this.getDate());//CHANGE before commit\n_this.socket.onopen=function(){console.log(\"socket connected\");};_this.socket.onclose=function(){console.log('socket closed');};_this.socket.onmessage=function(input){var data=JSON.parse(input.data);if(data.color){_this.setState({gameId:data.gameId,color:data.color});}};_this.props.setWs({socket:_this.socket});};return _this;}_createClass(Play,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.socket&&this.socket.readyState===WebSocket.OPEN){// console.log(\"socket closed\")\n// this.socket.close();\n}}},{key:\"render\",value:function render(){var redirect=this.state.gameId?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/game',state:{gameId:this.state.gameId,color:this.state.color,userId:this.state.userId}}}):null;return/*#__PURE__*/React.createElement(\"div\",null,redirect,/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(\"div\",{style:{height:'93vh',backgroundImage:'url('+chess+')',backgroundSize:'contain',textAlign:'center'}},/*#__PURE__*/React.createElement(\"div\",{className:\"homePage\"},/*#__PURE__*/React.createElement(Button,{className:\"button\",style:{backgroundColor:'grey',border:'1px solid black',marginBottom:'10vh',width:'250px'},onClick:this.search},\"PLAY ONLINE\"),/*#__PURE__*/React.createElement(Button,{className:\"button\",style:{backgroundColor:'grey',border:'1px solid black',width:'250px'},onClick:this.playWithFriends},\"PLAY WITH FRIENDS\"),this.state.playWithFriends?/*#__PURE__*/React.createElement(Redirect,{to:\"/playWithFriends\"}):null)),/*#__PURE__*/React.createElement(Modal,{backdrop:\"static\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,keyboard:false,show:this.state.waiting,onHide:this.hide,className:\"my-modal\"},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true,hidden:\"true\"}),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"h4\",{style:{marginBottom:'20px'}},\"Searching for Opponent\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Spinner,{animation:\"border\",variant:\"dark\"})),/*#__PURE__*/React.createElement(Button,{onClick:this.hide,className:\"button\",style:{backgroundColor:'black',border:'1px solid black',width:'150px',marginTop:'20px'}},\"CANCEL\")))));}}]);return Play;}(Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setWs:function setWs(data){var action={type:'WS',payload:data};return dispatch(action);}};};export default connect(null,mapDispatchToProps)(Play);","map":{"version":3,"sources":["/Users/ragir/Documents/chess/chess api/chess-online/chess-react/src/Play.js"],"names":["React","Component","Redirect","Button","Modal","Spinner","NavBar","chess","connect","Play","state","gameId","waiting","color","userId","playWithFriends","setState","getDate","Math","floor","Date","getTime","hide","console","log","socket","close","search","WebSocket","onopen","onclose","onmessage","input","data","JSON","parse","props","setWs","readyState","OPEN","redirect","pathname","height","backgroundImage","backgroundSize","textAlign","backgroundColor","border","marginBottom","width","marginTop","mapDispatchToProps","dispatch","action","type","payload"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport { Redirect } from 'react-router-dom'\nimport {Button, Modal, Spinner} from 'react-bootstrap'\nimport NavBar from './NavBar'\nimport chess from './chess1.jpg'\nimport { connect } from 'react-redux';\n\nclass Play extends Component{\n    state = {\n        gameId : null,\n        waiting : false,\n        color : null,\n        userId : null,\n        playWithFriends : false\n    }\n\n    playWithFriends = () => {\n        this.setState({playWithFriends : true})\n    }\n\n    getDate = () => {\n        const userId = Math.floor((new Date()).getTime() / 1000)\n        this.setState({userId : userId})\n        return userId\n    }\n\n    hide = () => {\n        this.setState({waiting: false})\n        console.log('socket closed')\n        this.socket.close()\n    }\n\n    search = () => {\n        this.setState({waiting: true});\n        this.socket = new WebSocket(\"ws://localhost:8080/online/\"+this.getDate()) //CHANGE before commit\n        this.socket.onopen = () => {\n            console.log(\"socket connected\");\n        }\n\n        this.socket.onclose = () => {\n            console.log('socket closed')\n        }\n\n        this.socket.onmessage = (input) => {\n            var data = JSON.parse(input.data);\n            if(data.color){\n                this.setState({gameId: data.gameId, color: data.color})\n            }\n        }\n\n        this.props.setWs({socket: this.socket});\n    }\n\n    componentWillUnmount() {\n        if (this.socket && this.socket.readyState === WebSocket.OPEN) {\n            // console.log(\"socket closed\")\n            // this.socket.close();\n         }\n    }\n\n    render(){\n        const redirect = this.state.gameId ? <Redirect to={{\n            pathname: '/game',\n            state: { \n                gameId: this.state.gameId,\n                color: this.state.color,\n                userId: this.state.userId\n            }\n        }} /> :null\n\n        return(\n            <div>\n                {redirect}\n                \n                <NavBar />\n                \n                <div style={{\n                    height:'93vh',\n                    backgroundImage: 'url('+chess+')',\n                    backgroundSize: 'contain',\n                    textAlign: 'center'\n                }}\n                >\n                    <div className='homePage'>\n                        <Button className='button' style={{backgroundColor: 'grey',border: '1px solid black',marginBottom: '10vh',width: '250px'}} onClick={this.search}>PLAY ONLINE</Button>\n                        <Button className='button' style={{backgroundColor: 'grey',border: '1px solid black',width: '250px'}} onClick={this.playWithFriends}>PLAY WITH FRIENDS</Button>\n                        {\n                            this.state.playWithFriends ? <Redirect to=\"/playWithFriends\" /> : null\n                        }\n                    </div>\n                </div>\n                <Modal backdrop=\"static\"\n                    aria-labelledby=\"contained-modal-title-vcenter\"\n                    centered\n                    keyboard={false}\n                    show={this.state.waiting}\n                    onHide={this.hide}\n                    className=\"my-modal\"\n                >\n                    <Modal.Header closeButton hidden=\"true\"></Modal.Header>\n                    <Modal.Body>\n                        <div style={{textAlign:\"center\"}}>\n                            <h4 style={{marginBottom:'20px'}}>Searching for Opponent</h4>\n                            <div>\n                                <Spinner animation=\"border\" variant=\"dark\" />\n                            </div>\n                            <Button onClick={this.hide} className='button' style={{backgroundColor:'black', border: '1px solid black',width: '150px',marginTop: '20px'}}>CANCEL</Button>\n                        </div>\n                    </Modal.Body>\n                </Modal>            \n            </div>            \n        )\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => ({\n    setWs: (data) => {\n        const action = {\n            type: 'WS',\n            payload: data\n        }\n        return dispatch(action)\n    } \n})\n\nexport default connect(null, mapDispatchToProps)(Play)\n"]},"metadata":{},"sourceType":"module"}
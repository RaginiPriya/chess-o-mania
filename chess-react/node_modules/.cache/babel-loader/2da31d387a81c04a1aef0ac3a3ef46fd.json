{"ast":null,"code":"import _classCallCheck from\"/Users/ragir/Desktop/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ragir/Desktop/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/ragir/Desktop/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/ragir/Desktop/chess api/chess-online/chess-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Modal,Spinner,Button,Form}from'react-bootstrap';import UserNavBar from'./UserNavBar';import{connect}from'react-redux';import{Redirect}from'react-router-dom';import{API_BASE_URL}from'./constants';var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.state={gameId:null,waiting:false,color:null,opponentName:null,opponentImageUrl:null,id:null,online:false,friends:false,invalid:false,join:false};_this.playOnline=function(){_this.setState({waiting:true});console.log(_this.props.user);_this.socket=new WebSocket(\"ws://localhost:8080/online/\"+_this.state.id);//CHANGE before commit\n_this.socket.onopen=function(){console.log(\"socket connected\");};_this.socket.onclose=function(){console.log('socket closed');};_this.socket.onmessage=function(input){var data=JSON.parse(input.data);if(data.color){_this.setState({online:true,gameId:data.gameId,color:data.color,opponentName:data.opponentName,opponentImageUrl:data.opponentImageUrl});}console.log(data);};_this.props.setWs({socket:_this.socket});};_this.hide=function(){_this.setState({waiting:false});console.log('socket closed');_this.socket.close();_this.props.setWs({socket:null});};_this.createGame=function(){_this.socket=new WebSocket(\"ws://localhost:8080/create/\"+_this.state.id);//CHANGE before commit\n_this.socket.onopen=function(){console.log(\"socket connected\");};_this.socket.onclose=function(){console.log('socket closed');};_this.socket.onmessage=function(input){var data=JSON.parse(input.data);if(data.type&&data.type==='gameId'){_this.setState({friends:true,gameId:data.gameId});}console.log(data);};_this.props.setWs({socket:_this.socket});};_this.showInvalid=function(){_this.setState({invalid:true});};_this.showJoin=function(){_this.setState({join:true});};_this.hideJoin=function(){_this.setState({join:false});if(_this.socket){_this.socket.close();}_this.props.setWs({socket:null});};_this.joinGame=function(){_this.socket=new WebSocket(\"ws://localhost:8080/join/\"+_this.state.id+\"/\"+_this.joinGameId.current.value);//CHANGE before commit\n_this.socket.onopen=function(){console.log(\"socket connected\");};_this.socket.onclose=function(){console.log('socket closed');};_this.socket.onmessage=function(input){var data=JSON.parse(input.data);if(data.type&&data.type==='gameId'){_this.setState({friends:true,gameId:data.gameId});}else if(data.color){_this.setState({friends:true,gameId:data.gameId,opponentName:data.opponentName,opponentImageUrl:data.opponentImageUrl,color:data.color});}else if(data.type&&data.type==='invalid'){_this.setState({invalid:true});}console.log(data);};_this.props.setWs({socket:_this.socket});};_this.joinGameId=React.createRef();return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(API_BASE_URL+'/user',{method:'GET',headers:{'Authorization':'Bearer '+this.props.user.token}}).then(function(response){return response.json();}).then(function(data){console.log(data);_this2.setState({id:data.id});_this2.props.setUser({username:data.name,imageUrl:data.imageUrl,id:data.id});});}},{key:\"render\",value:function render(){var redirect=this.state.gameId&&this.state.online?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/game',state:{gameId:this.state.gameId,color:this.state.color,opponentName:this.state.opponentName,opponentImageUrl:this.state.opponentImageUrl}}}):this.state.gameId&&this.state.friends?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/waitingroom',state:{gameId:this.state.gameId,color:this.state.color,opponentName:this.state.opponentName,opponentImageUrl:this.state.opponentImageUrl}}}):null;var className=\"\".concat(this.state.invalid?'error':'hide-error');var classNameText=\"\".concat(this.state.invalid?'error-texbox':'');return/*#__PURE__*/React.createElement(\"div\",null,redirect,/*#__PURE__*/React.createElement(UserNavBar,null),/*#__PURE__*/React.createElement(\"div\",{className:\"leftHalf grow\",onClick:this.playOnline},/*#__PURE__*/React.createElement(\"div\",{className:\"imageBox\"},\"PLAY ONLINE\"),/*#__PURE__*/React.createElement(\"div\",{className:\"imageBox-text\"},\"Compete against strangers online\")),/*#__PURE__*/React.createElement(\"div\",{className:\"rightHalf grow \"},/*#__PURE__*/React.createElement(\"div\",{className:\"imageBox\"},\"PLAY WITH FRIENDS\"),/*#__PURE__*/React.createElement(\"div\",{className:\"imageBox-text\",style:{left:'24%'}},/*#__PURE__*/React.createElement(\"div\",null,\"Create or join a room and compete against your friend\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{onClick:this.createGame,className:\"button\",style:{backgroundColor:' rgb(142, 68, 173)',border:'1px solid white',width:'150px',marginTop:'20px'}},\"CREATE ROOM\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{onClick:this.showJoin,className:\"button\",style:{backgroundColor:' rgb(142, 68, 173)',border:'1px solid white',width:'150px',marginTop:'20px'}},\"JOIN ROOM\")))),/*#__PURE__*/React.createElement(Modal,{backdrop:\"static\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,keyboard:false,show:this.state.waiting,onHide:this.hide,className:\"my-modal\"},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true,hidden:\"true\"}),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"h4\",{style:{marginBottom:'20px'}},\"Searching for Opponent\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Spinner,{animation:\"border\",variant:\"light\"})),/*#__PURE__*/React.createElement(Button,{onClick:this.hide,className:\"button\",style:{backgroundColor:' rgb(142, 68, 173)',border:'1px solid white',width:'150px',marginTop:'20px'}},\"CANCEL\")))),/*#__PURE__*/React.createElement(Modal,{backdrop:\"static\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,keyboard:false,show:this.state.join,onHide:this.hideJoin,className:\"my-modal\"},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true,hidden:\"true\"}),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(Form.Control,{className:classNameText,ref:this.joinGameId,type:\"text\",placeholder:\"Enter Room ID\"}),/*#__PURE__*/React.createElement(\"div\",{className:className},\"* Invalid Room ID\"),/*#__PURE__*/React.createElement(Button,{onClick:this.joinGame,className:\"button\",style:{backgroundColor:' rgb(142, 68, 173)',border:'1px solid white',width:'150px',marginTop:'20px'}},\"OK\"),/*#__PURE__*/React.createElement(Button,{onClick:this.hideJoin,className:\"button\",style:{backgroundColor:' rgb(142, 68, 173)',border:'1px solid white',width:'150px',marginTop:'20px'}},\"CANCEL\")))));}}]);return Home;}(Component);var mapStateToProps=function mapStateToProps(state){return{user:state.userReducer};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setWs:function setWs(data){var action={type:'WS',payload:data};return dispatch(action);},setUser:function setUser(data){var action={type:'SET_USER',payload:data};return dispatch(action);}};};export default connect(mapStateToProps,mapDispatchToProps)(Home);","map":{"version":3,"sources":["/Users/ragir/Desktop/chess api/chess-online/chess-react/src/Home.js"],"names":["React","Component","Modal","Spinner","Button","Form","UserNavBar","connect","Redirect","API_BASE_URL","Home","props","state","gameId","waiting","color","opponentName","opponentImageUrl","id","online","friends","invalid","join","playOnline","setState","console","log","user","socket","WebSocket","onopen","onclose","onmessage","input","data","JSON","parse","setWs","hide","close","createGame","type","showInvalid","showJoin","hideJoin","joinGame","joinGameId","current","value","createRef","fetch","method","headers","token","then","response","json","setUser","username","name","imageUrl","redirect","pathname","className","classNameText","left","backgroundColor","border","width","marginTop","textAlign","marginBottom","mapStateToProps","userReducer","mapDispatchToProps","dispatch","action","payload"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Modal, Spinner, Button, Form } from 'react-bootstrap'\nimport UserNavBar from './UserNavBar'\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router-dom'\nimport {API_BASE_URL} from './constants'\n\nclass Home extends Component {\n    state = {\n        gameId: null,\n        waiting: false,\n        color: null,\n        opponentName: null,\n        opponentImageUrl: null,\n        id: null,\n        online: false,\n        friends: false,\n        invalid: false,\n        join: false,\n    }\n\n    constructor(props) {\n        super(props);\n        this.joinGameId = React.createRef();\n    }\n\n    componentDidMount() {\n        fetch(API_BASE_URL+'/user', {\n                method: 'GET',\n                headers: {\n                  'Authorization': 'Bearer ' + this.props.user.token,\n                }\n            })\n                .then((response) => {\n                    return response.json()\n                })\n                .then((data) => {\n                    console.log(data)\n                    this.setState({id:data.id})\n                    this.props.setUser({username: data.name, imageUrl: data.imageUrl, id: data.id})\n                })\n    }\n\n    playOnline = () => {\n        this.setState({ waiting: true });\n        console.log(this.props.user)\n        this.socket = new WebSocket(\"ws://localhost:8080/online/\" + this.state.id) //CHANGE before commit\n        this.socket.onopen = () => {\n            console.log(\"socket connected\");\n        }\n\n        this.socket.onclose = () => {\n            console.log('socket closed')\n        }\n\n        this.socket.onmessage = (input) => {\n            var data = JSON.parse(input.data);\n            if (data.color) {\n                this.setState({ online: true, gameId: data.gameId, color: data.color, opponentName: data.opponentName, opponentImageUrl: data.opponentImageUrl })\n            }\n            console.log(data)\n        }\n\n        this.props.setWs({ socket: this.socket });\n    }\n\n    hide = () => {\n        this.setState({ waiting: false })\n        console.log('socket closed')\n        this.socket.close()\n        this.props.setWs({ socket: null });\n    }\n\n    createGame = () => {\n        this.socket = new WebSocket(\"ws://localhost:8080/create/\" + this.state.id) //CHANGE before commit\n        this.socket.onopen = () => {\n            console.log(\"socket connected\");\n        }\n\n        this.socket.onclose = () => {\n            console.log('socket closed')\n        }\n\n        this.socket.onmessage = (input) => {\n            var data = JSON.parse(input.data);\n            if (data.type && data.type === 'gameId') {\n                this.setState({ friends: true, gameId: data.gameId })\n            }\n            console.log(data)\n        }\n\n        this.props.setWs({ socket: this.socket });\n    }\n\n    showInvalid = () => {\n        this.setState({invalid: true})\n    }\n\n    showJoin = () => {\n        this.setState({join:true})\n    }\n\n    hideJoin = () => {\n        this.setState({join:false})\n        if(this.socket){\n            this.socket.close()\n        }\n        this.props.setWs({ socket: null });\n    }\n\n    joinGame = () => {\n\n        this.socket = new WebSocket(\"ws://localhost:8080/join/\" + this.state.id + \"/\" + this.joinGameId.current.value) //CHANGE before commit\n        this.socket.onopen = () => {\n            console.log(\"socket connected\");\n        }\n\n        this.socket.onclose = () => {\n            console.log('socket closed')\n        }\n\n        this.socket.onmessage = (input) => {\n            var data = JSON.parse(input.data)\n            if (data.type && data.type === 'gameId') {\n                this.setState({ friends: true, gameId: data.gameId })\n            }\n            else if(data.color) {\n                this.setState({ friends: true, gameId: data.gameId, opponentName: data.opponentName, opponentImageUrl: data.opponentImageUrl, color: data.color })\n            }\n            else if(data.type && data.type === 'invalid'){\n                this.setState({invalid: true})\n\n                \n            }\n            console.log(data)\n        }\n\n        this.props.setWs({ socket: this.socket });\n\n    }\n\n    render() {\n        const redirect = this.state.gameId && this.state.online ? <Redirect to={{\n            pathname: '/game',\n            state: { \n                gameId: this.state.gameId,\n                color: this.state.color,\n                opponentName: this.state.opponentName,\n                opponentImageUrl: this.state.opponentImageUrl\n            }\n        }} /> \n        : this.state.gameId && this.state.friends ? <Redirect to={{\n            pathname: '/waitingroom',\n            state: { \n                gameId: this.state.gameId,\n                color: this.state.color,\n                opponentName: this.state.opponentName,\n                opponentImageUrl: this.state.opponentImageUrl\n            }\n        }} />\n        : null\n        const className = `${this.state.invalid ? 'error' : 'hide-error'}`\n        const classNameText = `${this.state.invalid ? 'error-texbox' : ''}`\n        return (\n            \n            <div>\n                {redirect}\n                \n                <UserNavBar />\n                <div className='leftHalf grow' onClick={this.playOnline} >\n                    <div className='imageBox'>\n                        PLAY ONLINE\n                        </div>\n                    <div className='imageBox-text'>\n                        Compete against strangers online\n                    </div>\n                </div>\n\n\n                <div className='rightHalf grow '>\n                    <div className='imageBox'>\n                        PLAY WITH FRIENDS\n                    </div>\n                    <div className='imageBox-text' style={{left:'24%'}}>\n                        <div>Create or join a room and compete against your friend</div>\n                        <div><Button onClick={this.createGame} className='button' style={{ backgroundColor: ' rgb(142, 68, 173)', border: '1px solid white', width: '150px', marginTop: '20px' }}>CREATE ROOM</Button></div>\n                        \n                        <div><Button onClick={this.showJoin} className='button' style={{ backgroundColor: ' rgb(142, 68, 173)', border: '1px solid white', width: '150px', marginTop: '20px' }}>JOIN ROOM</Button></div>\n                    </div>\n                </div>\n                <Modal backdrop=\"static\"\n                    aria-labelledby=\"contained-modal-title-vcenter\"\n                    centered\n                    keyboard={false}\n                    show={this.state.waiting}\n                    onHide={this.hide}\n                    className=\"my-modal\"\n                >\n                    <Modal.Header closeButton hidden=\"true\"></Modal.Header>\n                    <Modal.Body>\n                        <div style={{ textAlign: \"center\" }}>\n                            <h4 style={{ marginBottom: '20px' }}>Searching for Opponent</h4>\n                            <div>\n                                <Spinner animation=\"border\" variant=\"light\" />\n                            </div>\n                            <Button onClick={this.hide} className='button' style={{ backgroundColor: ' rgb(142, 68, 173)', border: '1px solid white', width: '150px', marginTop: '20px' }}>CANCEL</Button>\n                        </div>\n                    </Modal.Body>\n                </Modal>\n\n                <Modal backdrop=\"static\"\n                    aria-labelledby=\"contained-modal-title-vcenter\"\n                    centered\n                    keyboard={false}\n                    show={this.state.join}\n                    onHide={this.hideJoin}\n                    className=\"my-modal\"\n                >\n                    <Modal.Header closeButton hidden=\"true\"></Modal.Header>\n                    <Modal.Body>\n                        <div style={{ textAlign: \"center\" }}>\n                        <Form.Control className={classNameText} ref={this.joinGameId} type=\"text\" placeholder=\"Enter Room ID\" />\n                        <div className={className}>* Invalid Room ID</div>\n                        <Button onClick={this.joinGame} className='button' style={{ backgroundColor: ' rgb(142, 68, 173)', border: '1px solid white', width: '150px', marginTop: '20px' }}>OK</Button>\n                        <Button onClick={this.hideJoin} className='button' style={{ backgroundColor: ' rgb(142, 68, 173)', border: '1px solid white', width: '150px', marginTop: '20px' }}>CANCEL</Button>\n                        </div>\n                    </Modal.Body>\n                </Modal>\n\n\n\n            </div>\n\n        )\n    }\n}\n\nconst mapStateToProps = (state) => ({\n    user: state.userReducer\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n    setWs: (data) => {\n        const action = {\n            type: 'WS',\n            payload: data\n        }\n        return dispatch(action)\n    },\n    setUser: (data) => {\n        const action = {\n            type: 'SET_USER',\n            payload: data\n        }\n        return dispatch(action)\n    } \n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Home)"]},"metadata":{},"sourceType":"module"}